At present this solution is broken, it can be fixed with hacks, however a better algorithm is needed.
